<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>QUIZ - ras-cal.com</title>
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<style>
  html, body {
    margin: 0;
    width: 100%;
    height: 100%;
    background: black;
    overflow: hidden;
    font-family: Arial, sans-serif;
  }

  #pdf-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
  }

  #pdf-canvas {
    position: absolute;
    display: block;
  }

  .annotationLayer {
    position: absolute;
    pointer-events: auto;
  }

  .annotationLayer a {
    border: none;
    text-decoration: underline;
    color: #00f;
    background: transparent;
    cursor: pointer;
    position: absolute;
    display: block;
  }

  /* --- Centered form --- */
  .pdf-form {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    
    background: rgba(255, 255, 255, 0.95);
    padding: 16px 20px;
    border-radius: 8px;
    box-shadow: 0 10px 20px rgba(0,0,0,0.5);
    z-index: 10;
    min-width: 220px;
  }

  .pdf-form input {
    display: block;
    margin-bottom: 10px;
    width: 100%;
    padding: 6px 8px;
    box-sizing: border-box;
  }

  .pdf-form button {
    padding: 6px 12px;
    cursor: pointer;
  }
</style>
</head>
<body>
<div id="pdf-wrapper">
  <canvas id="pdf-canvas"></canvas>
  <div id="annotation-layer" class="annotationLayer"></div>

  <!-- Centered form overlay -->
  <form class="pdf-form" id="height-form">
    <h1Q</h1>
    <h3>are you taller than ras-cal?</h3>
  
    <div style="display:flex; gap:8px; margin-bottom:10px;">
    <input type="number" id="feet" min="0" placeholder="Feet" required />
      <input type="number" id="inches" min="0" max="11" placeholder="Inches" required />
    </div>
  
    <button type="submit">Check</button>  
  
    <p id="height-result" style="margin-top:10px; font-weight:bold;"></p>
</form>
</div>

<script src="/pdf.min.js"></script>
<script>
pdfjsLib.GlobalWorkerOptions.workerSrc = '/pdf.worker.min.js';

const url = '/quiz/blank.pdf';
const canvas = document.getElementById('pdf-canvas');
const ctx = canvas.getContext('2d');
const annotationLayer = document.getElementById('annotation-layer');
const wrapper = document.getElementById('pdf-wrapper');

async function renderPDF() {
  const pdf = await pdfjsLib.getDocument(url).promise;
  const page = await pdf.getPage(1);

  const viewport = page.getViewport({ scale: 1 });
  const scale = Math.min(
    wrapper.clientWidth / viewport.width,
    wrapper.clientHeight / viewport.height
  );
  const scaled = page.getViewport({ scale });

  // Canvas size and position
  canvas.width = scaled.width;
  canvas.height = scaled.height;
  const canvasLeft = (wrapper.clientWidth - scaled.width) / 2;
  const canvasTop = (wrapper.clientHeight - scaled.height) / 2;
  canvas.style.left = canvasLeft + 'px';
  canvas.style.top = canvasTop + 'px';
  canvas.style.width = scaled.width + 'px';
  canvas.style.height = scaled.height + 'px';

  // Annotation layer
  annotationLayer.style.width = scaled.width + 'px';
  annotationLayer.style.height = scaled.height + 'px';
  annotationLayer.style.left = canvasLeft + 'px';
  annotationLayer.style.top = canvasTop + 'px';
  annotationLayer.innerHTML = '';

  // Render PDF page
  await page.render({ canvasContext: ctx, viewport: scaled }).promise;

  // Render clickable links
  const annotations = await page.getAnnotations({ intent: 'display' });
  annotations.forEach(ann => {
    if (ann.subtype === 'Link' && ann.url) {
      const rect = pdfjsLib.Util.normalizeRect(ann.rect);
      const a = document.createElement('a');
      a.href = ann.url;
      a.rel = 'noopener noreferrer';

      a.style.left = rect[0] * scale + 'px';
      a.style.top = (scaled.height - rect[3] * scale) + 'px';
      a.style.width = (rect[2] - rect[0]) * scale + 'px';
      a.style.height = (rect[3] - rect[1]) * scale + 'px';

      annotationLayer.appendChild(a);
    }
  });
}

// Initial render
renderPDF();
window.addEventListener('resize', renderPDF);
window.addEventListener('orientationchange', renderPDF);

const form = document.getElementById('height-form');
const result = document.getElementById('height-result');

form.addEventListener('submit', e => {
  e.preventDefault();

  const feet = parseInt(document.getElementById('feet').value, 10);
  const inches = parseInt(document.getElementById('inches').value, 10);

  const totalInches = feet * 12 + inches;
  const reference = 6 * 12 + 4; // 5'7"

  if (totalInches > reference) {
    result.textContent = "you MIGHT be taller than ras-cal";
  } else if (totalInches < reference) {
    result.textContent = "you're short but don't feel bad, ras-cal's just really tall";
  } else {
    result.textContent = "oh you think you're tall huh";
  }
});

</script>
</body>
</html>
